<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Zombie Slayer ‚Äî City Runner</title>
<style>
  :root{
    --bg:#0b0f14; --panel:#071018; --accent:#36c2b5; --muted:#98a3a6;
  }
  html,body{height:100%;margin:0;font-family:Inter,system-ui,Roboto,Arial;background:linear-gradient(180deg,#051217,#071018);color:#e8fbf7}
  .wrap{min-height:100vh;display:flex;align-items:center;justify-content:center;padding:14px}
  .game{width:100%;max-width:480px;border-radius:12px;overflow:hidden;border:1px solid rgba(255,255,255,0.03);box-shadow:0 10px 40px rgba(0,0,0,0.6);background:linear-gradient(180deg,#071016,#061014)}
  header{display:flex;gap:12px;align-items:center;padding:12px 14px}
  .logo{width:44px;height:44px;border-radius:10px;background:linear-gradient(180deg,#52d6c7,#2d9f95);display:flex;align-items:center;justify-content:center;font-size:20px}
  h1{margin:0;font-size:18px;color:var(--accent)} .lead{margin:0;color:var(--muted);font-size:12px}

  .stage-wrap{position:relative;background:linear-gradient(180deg,#0b1520,#071018);height:360px;overflow:hidden;border-top:1px solid rgba(255,255,255,0.02);border-bottom:1px solid rgba(255,255,255,0.02)}
  /* city background strips for parallax */
  .bg-layer{position:absolute;left:0;top:0;right:0;bottom:0;pointer-events:none}
  .bg-tile{position:absolute;bottom:0;height:160px;right:0;left:-50%;background-repeat:repeat-x;background-position:left bottom}
  .bg-buildings{background-image:linear-gradient(90deg, rgba(255,255,255,0.02) 1px, transparent 1px), linear-gradient(#0c1922,#082027); background-size: 40px 160px; opacity:0.9}
  .bg-road{height:120px;bottom:0;background:linear-gradient(180deg,#1b2226,#0f1517);box-shadow:inset 0 6px 16px rgba(0,0,0,0.6)}
  .ground-line{position:absolute;left:0;right:0;bottom:36px;height:4px;background:linear-gradient(90deg,#2f3a3d,#111416);opacity:0.7}

  /* characters */
  .player, .zombie{position:absolute;bottom:40px;width:120px;height:150px;display:flex;align-items:flex-end;justify-content:center;transition:transform .18s linear}
  .player{left:18%}
  .zombie{right:6%}
  .card{width:110px;height:130px;border-radius:12px;background:linear-gradient(180deg,rgba(255,255,255,0.03),transparent);display:flex;align-items:center;justify-content:center;box-shadow:0 8px 20px rgba(0,0,0,0.5)}
  .label{font-size:12px;color:var(--muted);text-align:center;margin-top:6px}

  /* HUD */
  .hud{display:flex;justify-content:space-between;align-items:center;padding:10px 14px;gap:8px}
  .stats{display:flex;gap:12px;align-items:center;color:var(--muted);font-size:13px}
  .xpbar{height:10px;background:rgba(255,255,255,0.05);border-radius:999px;overflow:hidden;width:160px}
  .xpbar > i{height:100%;background:linear-gradient(90deg,#ffd166,#ff8a66);width:6%}

  .controls{display:flex;gap:8px;align-items:center;padding:12px;justify-content:center}
  button.ghost{background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--muted);padding:8px 12px;border-radius:10px}
  .log{height:110px;background:linear-gradient(180deg,#061315,#051214);padding:12px;border-radius:10px;margin:12px;border:1px solid rgba(255,255,255,0.02);overflow:auto;color:#cfe7e4;font-size:14px}

  .hit{animation:hitAnim .18s linear}
  @keyframes hitAnim{0%{transform:translateY(0)}50%{transform:translateY(-10px) scale(1.02)}100%{transform:translateY(0)}}

  /* hit flash */
  .flash{position:absolute;width:160px;height:160px;border-radius:50%;background:radial-gradient(circle at 30% 30%, rgba(255,107,107,0.35), rgba(255,107,107,0.06) 20%, transparent 40%);pointer-events:none;opacity:0;transform:translate(-50%,-50%)}
  .flash.show{animation:flashAnim .22s ease-out forwards}
  @keyframes flashAnim{0%{opacity:1;transform:scale(.6)}100%{opacity:0;transform:scale(1.6)}}

  /* popup */
  .popup{position:fixed;left:50%;top:50%;transform:translate(-50%,-50%) scale(.95);background:linear-gradient(180deg,#071215,#061012);padding:12px;border-radius:12px;border:1px solid rgba(255,255,255,0.03);min-width:240px;z-index:60;display:none}
  .popup.show{display:block;animation:pop .16s ease-out forwards}
  @keyframes pop{from{opacity:0;transform:translate(-50%,-50%) scale(.92)}to{opacity:1;transform:translate(-50%,-50%) scale(1)}}

  /* responsive */
  @media (max-width:420px){
    .stage-wrap{height:320px}
    .player,.zombie{width:96px;height:130px}
    .card{width:90px;height:110px}
  }
</style>
</head>
<body>
<div class="wrap">
  <div class="game" id="gameBox">
    <header>
      <div class="logo">üèôÔ∏è</div>
      <div>
        <h1>Zombie Slayer ‚Äî City Run</h1>
        <p class="lead">Auto run ‚Ä¢ Auto fight ‚Ä¢ XP & Level</p>
      </div>
    </header>

    <div class="stage-wrap" id="stageWrap">
      <div class="bg-layer">
        <div class="bg-tile bg-buildings" id="bg1" style="bottom:120px"></div>
        <div class="bg-tile bg-buildings" id="bg2" style="bottom:120px;left:50%"></div>
        <div class="bg-tile bg-road" id="road1" style="height:120px;bottom:0;left:0"></div>
        <div class="bg-tile bg-road" id="road2" style="height:120px;bottom:0;left:50%"></div>
        <div class="ground-line"></div>
      </div>

      <!-- characters -->
      <div class="player" id="player">
        <div class="card" id="playerCard">
          <!-- player svg -->
          <svg width="92" height="110" viewBox="0 0 92 110" xmlns="http://www.w3.org/2000/svg">
            <rect x="6" y="10" width="80" height="90" rx="12" fill="#2b8f6b"/>
            <circle cx="46" cy="34" r="20" fill="#fff6ea"/>
            <circle cx="40" cy="32" r="3" fill="#2d2d2d"/>
            <circle cx="52" cy="32" r="3" fill="#2d2d2d"/>
            <rect x="34" y="52" width="24" height="10" rx="5" fill="#6be6a5"/>
            <path d="M28 78c8 6 18 6 30 0" stroke="#0a2b1e" stroke-width="2" stroke-linecap="round"/>
          </svg>
        </div>
        <div class="label">You</div>
      </div>

      <div class="zombie" id="zombie" style="display:none">
        <div class="card" id="zCard">
          <svg width="92" height="110" viewBox="0 0 92 110" xmlns="http://www.w3.org/2000/svg">
            <rect x="6" y="10" width="80" height="90" rx="12" fill="#6b3b8f"/>
            <ellipse cx="46" cy="36" rx="22" ry="18" fill="#a18ad1"/>
            <rect x="34" y="48" width="24" height="10" rx="5" fill="#c3b0e3"/>
            <path d="M30 76c10 8 18 8 30 0" stroke="#3a2450" stroke-width="2" stroke-linecap="round"/>
          </svg>
        </div>
        <div class="label">Zombie</div>
      </div>

      <div class="flash" id="flash"></div>
    </div>

    <div class="hud">
      <div class="stats">
        <div>‚ù§ HP: <strong id="hp">100</strong></div>
        <div>‚≠ê Lv: <strong id="lvl">1</strong></div>
        <div style="display:flex;align-items:center">XP: <div class="xpbar" style="margin-left:8px"><i id="xpMeter" style="width:6%"></i></div></div>
      </div>
      <div class="stats">
        <div style="color:var(--muted)">Inventory: <strong id="invCount">0</strong></div>
      </div>
    </div>

    <div class="controls">
      <button class="ghost" id="pauseBtn">‚è∏ Pause</button>
      <button class="ghost" id="saveBtn">üíæ Save</button>
    </div>

    <div class="log" id="log">Game loaded ‚Äî player runs automatically. Zombies will spawn and you will auto-attack.</div>

  </div>
</div>

<!-- loot popup -->
<div class="popup" id="lootPopup">
  <div style="font-weight:700;margin-bottom:8px">Loot Dropped!</div>
  <div id="lootBox" style="display:flex;gap:8px;justify-content:center"></div>
  <div style="margin-top:10px;display:flex;justify-content:flex-end">
    <button class="ghost" id="lootClose">OK</button>
  </div>
</div>

<script>
/* Game state */
let player = { hp:100, maxHp:100, level:1, xp:0, baseDamage:18, inv:[] };
let zombies = []; // active zombies
let isRunning = true;
let lastSpawn = 0;
let spawnInterval = 1600; // ms
let scrollX = 0;
const stageWrap = document.getElementById('stageWrap');
const playerEl = document.getElementById('player');
const zombieEl = document.getElementById('zombie');
const flash = document.getElementById('flash');
const logEl = document.getElementById('log');
const hpEl = document.getElementById('hp');
const lvlEl = document.getElementById('lvl');
const xpMeter = document.getElementById('xpMeter');
const invCount = document.getElementById('invCount');
const lootPopup = document.getElementById('lootPopup');
const lootBox = document.getElementById('lootBox');

function writeLog(t){ logEl.innerHTML = `<div style="margin-bottom:8px">${t}</div>` + logEl.innerHTML; }

/* parallax background elements */
const bg1 = document.getElementById('bg1');
const bg2 = document.getElementById('bg2');
const road1 = document.getElementById('road1');
const road2 = document.getElementById('road2');

function spawnZombie(){
  const z = {
    id: 'z'+Date.now(),
    x: stageWrap.clientWidth + 40 + Math.random()*220, // start off screen right
    y: 0,
    hp: 50 + Math.floor(player.level*10) + Math.floor(Math.random()*30),
    maxHp: 0,
    speed: 0.6 + Math.random()*0.8 + player.level*0.05
  };
  z.maxHp = z.hp;
  zombies.push(z);
  writeLog(`Zombie spawned (HP ${z.hp})`);
}

/* save/load */
function saveState(){
  try{
    const s = JSON.stringify(player);
    localStorage.setItem('zs_city_v1', s);
    writeLog('Game saved.');
  }catch(e){}
}
function loadState(){
  try{
    const s = localStorage.getItem('zs_city_v1');
    if(s){
      const p = JSON.parse(s);
      player = {...player,...p};
      writeLog('Saved state loaded.');
    }
  }catch(e){}
}

/* main loop */
let lastTime = 0;
function loop(ts){
  if(!lastTime) lastTime = ts;
  const dt = ts - lastTime;
  lastTime = ts;
  if(isRunning){
    // background scroll (parallax)
    scrollX += dt * 0.08; // base speed
    bg1.style.backgroundPosition = `${-scrollX*0.15}px bottom`;
    bg2.style.backgroundPosition = `${-scrollX*0.2 + 200}px bottom`;
    road1.style.backgroundPosition = `${-scrollX}px bottom`;
    road2.style.backgroundPosition = `${-scrollX + 400}px bottom`;

    // spawn zombies
    lastSpawn += dt;
    if(lastSpawn > spawnInterval){
      spawnZombie();
      lastSpawn = 0;
      // gradually speed up spawn a little
      spawnInterval = Math.max(900, spawnInterval - 8);
    }

    // update zombies
    for(let i=zombies.length-1;i>=0;i--){
      const z = zombies[i];
      z.x -= z.speed * dt * 0.12; // move left
      // if near player (player fixed x ~ left 18%)
      const playerX = stageWrap.clientWidth * 0.18 + 40;
      if(z.x <= playerX + 60 && z.hp > 0){
        // auto-attack sequence
        const playerHit = Math.floor(Math.random()*(player.baseDamage-6)) + Math.floor(player.baseDamage*0.6) + Math.floor(player.level*1.2);
        z.hp -= playerHit;
        showFlash('z');
        writeLog(`You hit zombie for ${playerHit} dmg`);
        // zombie retaliates
        if(z.hp > 0){
          const zh = Math.floor(Math.random()*(8 + player.level)) + Math.floor(4 + player.level*0.7);
          player.hp -= zh;
          showFlash('p');
          writeLog(`Zombie hits you for ${zh} dmg`);
        }
      }
      // remove dead or passed
      if(z.hp <= 0){
        // xp & loot
        const gained = Math.floor(12 + player.level*5 + Math.random()*12);
        player.xp += gained;
        writeLog(`Zombie killed! +${gained} XP`);
        maybeLoot();
        // remove
        zombies.splice(i,1);
        continue;
      }
      if(z.x < -120) { // off-screen left
        zombies.splice(i,1);
        continue;
      }
    }

    // player death check
    if(player.hp <= 0){
      writeLog('üíÄ You died! Respawning with half HP...');
      player.hp = Math.max(10, Math.floor(player.maxHp/2));
      player.xp = Math.max(0, player.xp - Math.floor(xpToLevel()*0.12));
    }

    // level up
    if(player.xp >= xpToLevel()){
      player.xp -= xpToLevel();
      player.level += 1;
      player.maxHp += 10;
      player.baseDamage += 3;
      writeLog(`üéâ Level up! Lv ${player.level}`);
    }

    updateUI();
  }
  requestAnimationFrame(loop);
}

function xpToLevel(){ return 120 + (player.level-1)*60; }

function updateUI(){
  hpEl.textContent = Math.max(0, Math.round(player.hp));
  lvlEl.textContent = player.level;
  const xpP = Math.min(100, Math.round((player.xp / xpToLevel()) * 100));
  xpMeter.style.width = xpP + '%';
  invCount.textContent = player.inv.length;
  // render one zombie visually (nearest) for simple UI
  if(zombies.length>0){
    const z = zombies[0];
    zombieEl.style.display = 'block';
    // position by z.x (map width ~ stageWrap.clientWidth)
    const xPercent = Math.max(8, Math.min(80, (z.x / stageWrap.clientWidth) * 100));
    zombieEl.style.right = (100 - xPercent) + '%';
    // update zombie card to show HP visually
    document.getElementById('zCard').style.opacity = Math.max(0.4, z.hp / z.maxHp);
  } else {
    zombieEl.style.display = 'none';
  }
}

function showFlash(target){
  if(!flash) return;
  if(target==='z'){ flash.style.left = '72%'; }
  else { flash.style.left = '28%'; }
  flash.classList.remove('show'); void flash.offsetWidth;
  flash.classList.add('show');
}

/* loot */
function maybeLoot(){
  if(Math.random() < 0.46){
    const item = { id:'it'+Date.now(), name: (Math.random()>0.85?'Epic ':'') + ['Sword','Shield','Boots','Ring'][Math.floor(Math.random()*4)], dmg: Math.floor(2+Math.random()*8) };
    player.inv.push(item);
    showLoot(item);
  } else {
    writeLog('No loot.');
  }
}
function showLoot(it){
  lootBox.innerHTML = `<div style="font-weight:700">${it.name}</div><div style="font-size:12px;color:var(--muted)">DMG:${it.dmg}</div>`;
  lootPopup.classList.add('show');
  lootPopup.style.display = 'block';
}

/* controls */
document.getElementById('lootClose').addEventListener('click', ()=>{
  lootPopup.classList.remove('show'); lootPopup.style.display='none';
});
document.getElementById('pauseBtn').addEventListener('click', ()=>{
  isRunning = !isRunning; document.getElementById('pauseBtn').textContent = isRunning? '‚è∏ Pause':'‚ñ∂ Resume';
});
document.getElementById('saveBtn').addEventListener('click', saveState);

/* init */
loadState();
updateUI();
requestAnimationFrame(loop);

// initial spawn a few so it feels active
setTimeout(()=>{ spawnZombie(); spawnZombie(); }, 400);
</script>
</body>
</html>
